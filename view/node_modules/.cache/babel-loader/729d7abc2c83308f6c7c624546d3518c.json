{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// import {login} from '../api/login';\nexport default {\n  data: function data() {\n    return {\n      loginForm: {\n        email: '',\n        password: ''\n      },\n      loginRules: {\n        email: [{\n          type: 'email',\n          required: true,\n          trigger: 'blur',\n          message: 'Input Email box'\n        }, {\n          pattern: /^[a-zA-Z0-9_.-]{2,30}@(student.xjtlu.edu.cn)$/,\n          message: 'Please use XITLU campus email'\n        }],\n        password: [{\n          required: true,\n          message: 'Input password',\n          trigger: 'blur'\n        }, {\n          pattern: /^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{6,16}$/,\n          message: 'Please contain both numbers and letters and be 6-16 characters in length'\n        }]\n      },\n      loading: false,\n      passwordType: 'password',\n      redirect: undefined\n    };\n  },\n  watch: {\n    $route: {\n      handler: function handler(route) {\n        this.redirect = route.query && route.query.redirect;\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    goTo: function goTo() {\n      this.$router.push('/register');\n    },\n    handleLogin: function handleLogin() {\n      var _this = this;\n\n      this.$https.post('/user/login', {\n        email: this.loginForm.email,\n        password: this.loginForm.password\n      }).then(function (res) {\n        console.log(res);\n\n        if (res.status === 200) {\n          _this.$message({\n            showClose: true,\n            message: 'Login succeeded, skipping to the home page...',\n            type: 'success'\n          }); //保存用户id\n\n\n          var data = res.data;\n          localStorage.setItem('userId', res.data);\n          setTimeout(function () {\n            _this.$router.push('/home');\n          }, 2000); //取值\n          // localStorage.getItem(userId)\n        } else if (res.status === 400) {\n          _this.$message({\n            showClose: true,\n            message: 'Failed. Please try again',\n            type: 'error'\n          });\n        } else if (res.status === 416) {\n          _this.$message({\n            showClose: true,\n            message: 'You are a new user.Go and register first',\n            type: 'error'\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AAEA;AAEAA,MAFA,kBAEA;AACA;AACAC;AACAC,iBADA;AAEAC;AAFA,OADA;AAKAC;AACAF;AAAAG;AAAAC;AAAAC;AAAAC;AAAA,WACA;AAAAC;AAAAD;AAAA,SADA,CADA;AAIAL;AACAG,wBADA;AAEAE,mCAFA;AAGAD;AAHA,WAIA;AAAAE;AAAAD;AAAA,SAJA;AAJA,OALA;AAeAE,oBAfA;AAgBAC,8BAhBA;AAiBAC;AAjBA;AAmBA,GAtBA;AAuBAC;AACAC;AACAC;AACA;AACA,OAHA;AAIAC;AAJA;AADA,GAvBA;AA+BAC;AACAC,QADA,kBACA;AACA;AACA,KAHA;AAKAC,eALA,yBAKA;AAAA;;AACA;AAAAjB;AAAAC;AAAA;AACAiB;;AACA;AACA;AACAC,2BADA;AAEAb,oEAFA;AAGAH;AAHA,aADA,CAMA;;;AACA;AACAiB;AACAC;AACA;AACA,WAFA,EAEA,IAFA,EATA,CAYA;AACA;AACA,SAdA,MAcA;AACA;AACAF,2BADA;AAEAb,+CAFA;AAGAH;AAHA;AAKA,SANA,MAMA;AACA;AACAgB,2BADA;AAEAb,+DAFA;AAGAH;AAHA;AAKA;AACA,OA7BA;AA8BA;AApCA;AA/BA","names":["data","loginForm","email","password","loginRules","type","required","trigger","message","pattern","loading","passwordType","redirect","watch","$route","handler","immediate","methods","goTo","handleLogin","console","showClose","localStorage","setTimeout"],"sourceRoot":"src/views","sources":["login.vue"],"sourcesContent":["<template>\n\n  <div class=\"login-container\">\n\n    <el-form ref=\"loginForm\" :model=\"loginForm\" :rules=\"loginRules\" class=\"ms-content\" auto-complete=\"on\"\n             label-width=\"0px\">\n      <div class=\"ms-login\">\n        <h3 class=\"ms-title\">LOG IN</h3></div>\n\n      <el-form-item prop=\"username\">\n        <el-input ref=\"username\" v-model=\"loginForm.email\" placeholder=\"Email\" name=\"email\" type=\"text\"\n                  tabindex=\"1\" auto-complete=\"on\">\n          <i slot=\"prefix\" class=\"el-input__icon el-icon-user-solid\"></i>\n        </el-input>\n      </el-form-item>\n\n      <el-form-item prop=\"password\">\n        <el-input :key=\"passwordType\" ref=\"password\" v-model=\"loginForm.password\" :type=\"passwordType\"\n                  placeholder=\"Password\"\n                  name=\"password\" tabindex=\"2\" auto-complete=\"on\" @keyup.enter.native=\"handleLogin\" show-password>\n          <i slot=\"prefix\" class=\"el-input__icon el-icon-lock\"></i>\n        </el-input>\n      </el-form-item>\n\n\n      <el-button :loading=\"loading\" type=\"primary\" style=\"width:100%;margin-bottom:30px;background-color: #25c4b0\"\n                 @click.native.prevent=\"handleLogin\">Log in\n      </el-button>\n\n      <p class=\"tips\">Have no account?\n        <el-button type=\"info\" size=\"mini\" style=\"background-color: #25c4b0\" @click=\"goTo()\">Register</el-button>\n      </p>\n    </el-form>\n  </div>\n\n</template>\n\n<script>\n// import {login} from '../api/login';\n\nexport default {\n\n  data() {\n    return {\n      loginForm: {\n        email: '',\n        password: '',\n      },\n      loginRules: {\n        email: [{type: 'email', required: true, trigger: 'blur', message: 'Input Email box'},\n          {pattern: /^[a-zA-Z0-9_.-]{2,30}@(student.xjtlu.edu.cn)$/, message: 'Please use XITLU campus email'}\n        ],\n        password: [{\n          required: true,\n          message: 'Input password',\n          trigger: 'blur'\n        }, {pattern: /^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{6,16}$/, message: 'Please contain both numbers and letters and be 6-16 characters in length'}]\n      },\n      loading: false,\n      passwordType: 'password',\n      redirect: undefined\n    }\n  },\n  watch: {\n    $route: {\n      handler: function (route) {\n        this.redirect = route.query && route.query.redirect\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    goTo() {\n      this.$router.push('/register');\n    },\n\n    handleLogin() {\n      this.$https.post('/user/login',{email:this.loginForm.email,password:this.loginForm.password}).then(res => {\n        console.log(res)\n        if (res.status === 200) {\n          this.$message({\n            showClose: true,\n            message: 'Login succeeded, skipping to the home page...',\n            type: 'success'\n          })\n          //保存用户id\n          let data = res.data;\n          localStorage.setItem('userId',res.data);\n          setTimeout(() => {\n            this.$router.push('/home')\n          }, 2000)\n          //取值\n          // localStorage.getItem(userId)\n        }else if(res.status === 400){\n          this.$message({\n            showClose: true,\n            message: 'Failed. Please try again',\n            type: 'error'\n          })\n        }else if(res.status === 416){\n          this.$message({\n            showClose: true,\n            message: 'You are a new user.Go and register first',\n            type: 'error'\n          })\n        }\n      })\n    }\n  }\n}\n\n\n\n</script>\n\n<style scoped>\n\n.login-container {\n  position: relative;\n  width: 100%;\n  height: 110vh;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-image: url(../assets/new.jpg);\n}\n\n.ms-title {\n  line-height: 30px;\n  text-align: center;\n  font-size: 25px;\n  color: #fff;\n  border-bottom: 1px solid #ddd;\n  border-radius: 6px;\n  padding: 5px 25px 25px 5px;\n}\n\n.ms-title .el-input input {\n  height: 38px;\n}\n\n\n.ms-content {\n  padding: 30px 30px;\n  background: rgba(255, 255, 255, 0.3);\n  width: 300px;\n  height: 350px;\n  border-radius: 5px;\n  position: absolute;\n  left: 450px;\n  top: 160px;\n}\n\n.login-btn button {\n  width: 100%;\n  height: 36px;\n  margin-bottom: 10px;\n}\n\n.tips {\n  float: right;\n  font-size: 15px;\n  color: #fff;\n  margin-bottom: 10px;\n}\n</style>\n<!--<style>-->\n<!--.ms-login .el-input__inner {-->\n<!--  height: 40px !important;-->\n<!--}-->\n<!--</style>-->\n"]},"metadata":{},"sourceType":"module"}